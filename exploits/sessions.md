# Session Hijacking
Session hijacking, also sometimes known as **cookie hijacking** is the exploitation of a valid computer session (also called a **session key**) to gain unauthorized access to information or services in a computer system. This is particular relevance to web developers, as the [HTTP cookies](http://en.wikipedia.org/wiki/HTTP_cookie) used to maintain a session on many web sites can be easily stolen by an attacker.


### Session Sniffing
As you can see below, the attacker can use a sniffer to capture valid token called "Session ID", and then he/she can use that valid token session to gain unauthorized access to the server.
![Session Sniffing](https://www.owasp.org/images/c/cb/Session_Hijacking_3.JPG)


### Cross-site Script Attack
The attacker can compromise the session token by using malicious code or programs running at the client-side. The example shows how the attacker could use an XSS attack to steal the session token. If an attacker sends a crafted link to the victim with the malicious JavaScript, when the victim clicks on the link, the JavaScript will run and complete the instructions made by the attacker. The example in figure 3 uses an XSS attack to show the cookie value of the current session; using the same technique it's possible to create a specific JavaScript code that will send the cookie to the attacker.
```javascript
<script>alert(document.cookie);</script>
```
![Cross-site Script](https://www.owasp.org/images/b/b6/Code_Injection.JPG)


### Man-in-the-middle Attack
The man-in-the middle attack intercepts a communication between two systems. For example, in an http transaction the target is the TCP connection between client and server. Using different techniques, the attacker splits the original TCP connection into 2 new connections, one between the client and the attacker and the other between the attacker and the server, as shown in figure 1. Once the TCP connection is intercepted, the attacker acts as a proxy, being able to read, insert and modify the data in the intercepted communication.

![Man-in-the-middle Attack](https://www.owasp.org/images/2/21/Main_the_middle.JPG)


### Man-in-the-browser Attack
The Man-in-the-Browser attack is the same approach as Man-in-the-middle attack, but in this case a Trojan Horse is used to intercept and manipulate calls between the main application’s executable (ex: the browser) and its security mechanisms or libraries on-the-fly.  
The most common objective of this attack is to cause financial fraud by manipulating transactions of Internet Banking systems, even when other authentication factors are in use.  
A previously installed Trojan horse is used to act between the browser and the browser’s security mechanism, sniffing or modifying transactions as they are formed on the browser, but still displaying back the user's intended transaction.  
Normally, the victim must be smart in order to notice a signal of such attack while he is accessing a web application like an internet banking account, even in presence of SSL channels, because all expected controls and security mechanisms are displayed and work normally.

![Man-in-the-browser Attack 1](http://securityaffairs.co/wordpress/wp-content/uploads/2013/09/man-in-the-browser.gif)
![Man-in-the-browser Attack 2](https://media.licdn.com/mpr/mpr/shrinknp_750_750/AAEAAQAAAAAAAALQAAAAJGIwODIxM2YxLTczNTAtNDYzNS1hYzI0LWQ5ZTdmZDQ0ODQzMQ.jpg)
